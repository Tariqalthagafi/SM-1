import{d as B,r as g,n as I,a as h,f as $,l as P,c as l,b as r,t as d,u as b,F as w,p as x,m as L,i as D,o as i,_ as C,w as V,U as M,e as S,Y as N,V as A}from"./index-ffCe8qSf.js";import{i as f}from"./indexedDBService-9HYV5ySC.js";const O={backgroundColors:{menu:"خلفية القائمة",section:"خلفية القسم",product:"خلفية المنتج"},textColors:{sectionTitle:"عنوان القسم",productName:"اسم المنتج",price:"السعر",offer:"العرض",expired:"المنتهي"},font:"الخط",offerStyle:"نمط العرض",expiredStyle:"نمط المنتهي",imageShape:"شكل الصور",currencySymbol:"نمط العملة",allergenIconColor:"لون رمز الحساسية"},j={ar:O};let F="ar";function k(t){const o=t.split(".");let s=j[F];for(const u of o)if(s=s?.[u],!s)return t;return s}const z=B("colorEditorStore",()=>{const t=g({headerBackground:"#ffffff",sectionBackground:"#f5f5f5",cardBackground:"#ffffff",titleText:"#000000",priceText:"#333333",descriptionText:"#666666",allergenIcon:"#ff0000"});function o(e,v){t.value[e]=v}function s(e){t.value={...e}}async function u(){const e=await f.getColors("default");e&&typeof e=="object"&&(t.value=e)}async function _(){await f.saveColors(t.value,"default")}function a(){t.value={headerBackground:"#ffffff",sectionBackground:"#f5f5f5",cardBackground:"#ffffff",titleText:"#000000",priceText:"#333333",descriptionText:"#666666",allergenIcon:"#ff0000"}}return I(t,async e=>{await f.saveColors(e,"default")},{deep:!0}),{colors:t,setColor:o,setColors:s,loadColors:u,saveColors:_,resetColors:a}}),U={class:"color-editor"},K={class:"color-label"},Y=["value","onInput"],q={key:0},G=h({__name:"ColorEditor",setup(t){const o=z(),s=$(()=>o.colors);P(()=>{o.loadColors()});const u={headerBackground:"خلفية العنوان",sectionBackground:"خلفية القسم",cardBackground:"خلفية البطاقة",titleText:"لون عنوان المنتج",priceText:"لون السعر",descriptionText:"لون الوصف",allergenIcon:"لون رمز الحساسية"};function _(a,e){const v=e.target;o.setColor(a,v.value),o.saveColors()}return(a,e)=>(i(),l("div",U,[r("h5",null,d(b(k)("colorsSection")),1),(i(),l(w,null,x(u,(v,y,m)=>r("div",{key:String(y),class:"color-row"},[r("label",K,[D(d(v)+": ",1),r("input",{type:"color",value:s.value[y],onInput:p=>_(y,p)},null,40,Y)]),m<Object.keys(u).length-1?(i(),l("hr",q)):L("",!0)])),64))]))}}),H=C(G,[["__scopeId","data-v-a2efe9e8"]]),E=B("layoutEditorStore",()=>{const t=g("grid");function o(a){t.value=a}async function s(){const a=await f.getCustomization("template");a?.layout_id&&typeof a.layout_id=="string"&&(t.value=a.layout_id)}async function u(){const a=await f.getCustomization("template")||{id:"template"};a.layout_id=t.value,await f.saveCustomization(a,"template")}function _(){t.value="grid"}return I(t,async a=>{const e=await f.getCustomization("template")||{id:"template"};e.layout_id=a,await f.saveCustomization(e,"template")}),{layout:t,setLayout:o,loadLayout:s,saveLayout:u,resetLayout:_}}),J={class:"layout-editor"},Q=["value"],R=h({__name:"LayoutEditor",setup(t){const o=E();P(()=>{o.loadLayout()});const s=$({get:()=>o.layout,set:_=>{o.setLayout(_),o.saveLayout()}}),u=[{value:"vertical",label:"عمودي"},{value:"grid",label:"شبكي"},{value:"cards",label:"بطاقات"},{value:"sectioned",label:"عرض بالقسم"}];return(_,a)=>(i(),l("div",J,[r("h5",null,d(b(k)("اختيار النموذج")),1),V(r("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e)},[(i(),l(w,null,x(u,e=>r("option",{key:e.value,value:e.value},d(e.label||b(k)(`layouts.${e.value}`)),9,Q)),64))],512),[[M,s.value]])]))}}),W=C(R,[["__scopeId","data-v-441c1e15"]]),X={class:"template-customizer-2"},Z=h({__name:"TemplateCustomizer2",setup(t){return(o,s)=>(i(),l("div",X,[r("h4",null,d(b(k)("تخصيص المنيو")),1),S(W),S(H)]))}}),ee=C(Z,[["__scopeId","data-v-bf52f4e2"]]),te={key:0},oe={class:"preview-frame"},ae={class:"section-title"},se={class:"product-name"},ne={class:"product-price"},re={key:0,class:"old-price"},ce={class:"final-price"},le={key:1},ie=h({__name:"TemplatePreview",setup(t){const o=g([]),s=g([]),u=z(),_=E(),a=$(()=>{switch(_.layout){case"grid":return"layout-grid";case"vertical":return"layout-vertical";case"cards":return"layout-cards";case"sectioned":return"layout-sectioned";default:return"layout-default"}}),e=g("ر.س");function v(m){const p=document.documentElement;Object.entries(m).forEach(([c,n])=>{p.style.setProperty(`--${c}-bg`,n),p.style.setProperty(`--${c}-color`,n)}),p.style.setProperty("--font-family","Cairo")}async function y(){const m=await f.getAll("offers");o.value=await f.getAll("sections");const p=await f.getAll("products");s.value=p.map(c=>{const n=m.find(T=>T.id===c.selectedOfferId&&T.isActive);return n?n.type==="percentage"?c.finalPrice=Math.round((c.basePrice??0)*(1-n.discount/100)):n.type==="unifiedPrice"&&(c.finalPrice=n.discount):c.finalPrice=c.basePrice??0,c})}return P(()=>{y(),v(u.colors)}),N(()=>{v(u.colors)}),(m,p)=>o.value.length&&s.value.length?(i(),l("div",te,[p[0]||(p[0]=r("h4",null,"معاينة القالب",-1)),r("div",oe,[(i(!0),l(w,null,x(o.value,c=>(i(),l("div",{key:c.id,class:"menu-section"},[r("h5",ae,d(c.name),1),r("div",{class:A(["products",a.value])},[(i(!0),l(w,null,x(s.value.filter(n=>n.sectionId===c.id&&n.status==="visible"),n=>(i(),l("div",{key:n.id,class:"product-item"},[r("span",se,d(n.name),1),r("span",ne,[n.finalPrice!==n.basePrice?(i(),l("span",re,d(n.basePrice)+" "+d(e.value),1)):L("",!0),r("span",ce,d(n.finalPrice)+" "+d(e.value),1)])]))),128))],2)]))),128))])])):(i(),l("p",le,"جاري تحميل المعاينة..."))}}),ue=C(ie,[["__scopeId","data-v-e51107d3"]]),de={class:"menu-design-container"},fe={class:"menu-sidebar"},_e={class:"menu-preview-area"},pe=h({__name:"MenuDesign",setup(t){return(o,s)=>(i(),l("div",de,[r("aside",fe,[S(ee)]),r("main",_e,[S(ue)])]))}}),ye=C(pe,[["__scopeId","data-v-57eef924"]]);export{ye as default};
